<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
        <title>5.2 Stacking</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8"/>
    </head>
    <body class="body">
    Fixtures can stack on each other which can be an effective technique for creating complex fixtures out of simpler building blocks. This is best illustrated by an example...<p class="paragraph"/><div class="code"><pre>// fixtures/authors.groovy
fixture &#123;
  guillaume(Author, name: <span class="java&#45;quote">"Guillaume Laforge"</span>)
  dierk(Author, name: <span class="java&#45;quote">"Dierk Koenig"</span>)
&#125;<p class="paragraph"/>// fixtures/books.groovy
fixture &#123;
  gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>, authors: &#91;guillaume, dierk&#93;)
&#125;<p class="paragraph"/>fixtureLoader.load(<span class="java&#45;quote">"authors"</span>).load(<span class="java&#45;quote">"books"</span>)</pre></div><p class="paragraph"/>The fixture contained in <code>authors</code> is created and persisted, then the fixture in <code>books</code> is created and persisted independently. Note that the <code>books</code> fixture can refer to any objects loaded in a <em class="italic">parent</em> fixture by name.<p class="paragraph"/>This can also be done with inline fixtures...<p class="paragraph"/><div class="code"><pre>// fixtures/authors.groovy
fixture &#123;
&#125;<p class="paragraph"/>// fixtures/books.groovy
fixture &#123;
  gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>, authors: &#91;guillaume, dierk&#93;)
&#125;<p class="paragraph"/>fixtureLoader.load &#123;
  guillaume(Author, name: <span class="java&#45;quote">"Guillaume Laforge"</span>)
  dierk(Author, name: <span class="java&#45;quote">"Dierk Koenig"</span>)  
&#125;.load &#123;
  gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>, authors: &#91;guillaume, dierk&#93;)
&#125;</pre></div><p class="paragraph"/>While this is possible, it's not overly useful. What can be useful however is to build on a fixture inline...<p class="paragraph"/><div class="code"><pre>// fixtures/authors.groovy
fixture &#123;
  guillaume(Author, name: <span class="java&#45;quote">"Guillaume Laforge"</span>)
  dierk(Author, name: <span class="java&#45;quote">"Dierk Koenig"</span>)
&#125;<p class="paragraph"/>fixtureLoader.load(<span class="java&#45;quote">"authors"</span>).load &#123;
  gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>, authors: &#91;guillaume, dierk&#93;)
&#125;</pre></div><p class="paragraph"/>In a real work scenario, <code>authors</code> could contain common bean definitions that are used across many tests. Using this technique, you can reuse these common definitions and then conveniently augment/extend them in individual tests.
    </body>
</html>
