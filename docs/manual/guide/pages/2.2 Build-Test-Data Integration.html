<html>
     <head>
     	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
     	<title>2.2 Build-Test-Data Integration</title>
     	<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8">
     </head>
	<body class="body">
		The <a href="http://www.grails.org/plugin/build-test-data" target="blank">build-test-data plugin</a> is a great plugin that simplifies specifying test data by populating required properties for you that you don't care about in your particular test.<p class="paragraph"/>Consider the following class...<p class="paragraph"/><div class="code"><pre>// Book.groovy
class Book &#123;
  <span class="java&#45;object">String</span> title
  <span class="java&#45;object">String</span> isbn<p class="paragraph"/>  <span class="java&#45;keyword">static</span> constraints = &#123;
    title(required: <span class="java&#45;keyword">true</span>)
    isbn(required: <span class="java&#45;keyword">true</span>)
  &#125;
&#125;</pre></div><p class="paragraph"/>Whenever an instance of Book is created for a test, the <code>isbn</code> property has to be populated for the object to pass validation which can be distracting if your test does not care about the <code>isbn</code> property. The build-test-data plugin provides a static <code>build()</code> method on all domain classes that creates an instance with all non-specified, mandatory properties filled in with placeholder values that pass constrain tests. For more information, see the documentation on the plugin.<p class="paragraph"/>The fixtures plugin integrates with build-test-data by providing a <code>build()</code> method that has the same behaviour as <code>load()</code> except that objects are created via the build-test-data static <code>build()</code> method.<p class="paragraph"/>Which means that the following test will pass...<p class="paragraph"/><div class="code"><pre>def fixture = fixtureLoader.build &#123;
  gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>)
&#125;
assert fixture.gina.isbn != <span class="java&#45;keyword">null</span></pre></div><p class="paragraph"/>And is equivalent to...<p class="paragraph"/><div class="code"><pre>def gina = Book.build(title: <span class="java&#45;quote">"Groovy In Action"</span>)
assert gina.isbn != <span class="java&#45;keyword">null</span></pre></div><p class="paragraph"/>In fixture files, you can specify that build-test-data integration should be used by using the <code>build()</code> method instead of the usual <code>fixture()</code> method.<p class="paragraph"/><h4>Switching it on/off</h4><p class="paragraph"/>You may only want to define part of your fixture with build-test-data integration, or conversely you may want to define part of it without it. You can do this via the <code>build()</code> and <code>noBuild()</code> methods inside a fixture definition.<p class="paragraph"/><div class="code"><pre>fixtureLoader.load &#123;
  build &#123;
    gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>)
  &#125;
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>fixtureLoader.build &#123;
  noBuild &#123;
    gina(Book, title: <span class="java&#45;quote">"Groovy In Action"</span>, isbn: <span class="java&#45;quote">"12345678"</span>)
  &#125;
&#125;</pre></div><p class="paragraph"/><h4>Installing build-test-data</h4><p class="paragraph"/>Note that build-test-data integration only works if you have installed the build-test-data plugin yourself. The fixtures plugin does not attempt to install it for you.

	</body>
</html>